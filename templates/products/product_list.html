<!-- templates/products/product_list.html -->
{% extends 'base.html' %}
{% load static %}
{% load humanize %}

{% block title %}상품 관리 - Shopuda ERP{% endblock %}

{% block breadcrumb %}
<div class="flex items-center space-x-2">
    <i class="fas fa-home w-4 h-4"></i>
    <span class="text-gray-400 dark:text-gray-500">/</span>
    <span>상품 관리</span>
</div>
{% endblock %}

{% block extra_head %}
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
{% endblock %}

{% block content %}
<div class="space-y-6" x-data="productList()">
    <!-- 페이지 헤더 -->
    <div class="bg-white dark:bg-gray-800 shadow-xl rounded-2xl border border-gray-200 dark:border-gray-700">
        <div class="bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-700 px-6 py-8 rounded-t-2xl">
            <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
                <div class="flex items-center space-x-4">
                    <div class="w-16 h-16 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center">
                        <i class="fas fa-box text-white text-2xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl lg:text-3xl font-bold text-white">상품 관리</h1>
                        <p class="text-blue-100 font-medium">전체 {{ total_products }}개 상품</p>
                    </div>
                </div>
                <div class="flex flex-col sm:flex-row gap-3">
                    <a href="{% url 'products:create' %}" 
                       class="inline-flex items-center px-6 py-3 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white font-medium hover:bg-white/30 transition-all duration-200 hover:scale-105">
                        <i class="fas fa-plus mr-2"></i>
                        상품 등록
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- 통계 카드 -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">전체 상품</p>
                    <p class="text-2xl font-bold text-gray-900 dark:text-white">{{ total_products }}</p>
                </div>
                <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center">
                    <i class="fas fa-box text-blue-600 dark:text-blue-400"></i>
                </div>
            </div>
        </div>

        <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">부족 재고</p>
                    <p class="text-2xl font-bold text-orange-600 dark:text-orange-400">{{ low_stock_count }}</p>
                </div>
                <div class="w-12 h-12 bg-orange-100 dark:bg-orange-900 rounded-lg flex items-center justify-center">
                    <i class="fas fa-exclamation-triangle text-orange-600 dark:text-orange-400"></i>
                </div>
            </div>
        </div>

        <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">품절</p>
                    <p class="text-2xl font-bold text-red-600 dark:text-red-400">{{ out_of_stock_count }}</p>
                </div>
                <div class="w-12 h-12 bg-red-100 dark:bg-red-900 rounded-lg flex items-center justify-center">
                    <i class="fas fa-times-circle text-red-600 dark:text-red-400"></i>
                </div>
            </div>
        </div>

        <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">총 가치</p>
                    <p class="text-2xl font-bold text-green-600 dark:text-green-400">₩{{ total_value|floatformat:0|intcomma }}</p>
                </div>
                <div class="w-12 h-12 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center">
                    <i class="fas fa-won-sign text-green-600 dark:text-green-400"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- 검색 및 필터 -->
    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-200 dark:border-gray-700">
        <form method="get" class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">검색</label>
                    <input type="text" name="search" value="{{ current_filters.search }}"
                           placeholder="상품명, SKU 검색..."
                           class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">카테고리</label>
                    <select name="category" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white">
                        <option value="">전체</option>
                        {% for category in categories %}
                            <option value="{{ category.id }}" {% if current_filters.category == category.id|stringformat:"s" %}selected{% endif %}>
                                {{ category.name }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">브랜드</label>
                    <select name="brand" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white">
                        <option value="">전체</option>
                        {% for brand in brands %}
                            <option value="{{ brand.id }}" {% if current_filters.brand == brand.id|stringformat:"s" %}selected{% endif %}>
                                {{ brand.name }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">재고 상태</label>
                    <select name="stock_status" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white">
                        <option value="">전체</option>
                        <option value="normal" {% if current_filters.stock_status == 'normal' %}selected{% endif %}>정상</option>
                        <option value="low" {% if current_filters.stock_status == 'low' %}selected{% endif %}>부족</option>
                        <option value="out" {% if current_filters.stock_status == 'out' %}selected{% endif %}>품절</option>
                    </select>
                </div>
                
                <div class="flex items-end">
                    <button type="submit" class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200">
                        <i class="fas fa-search mr-2"></i>검색
                    </button>
                </div>
            </div>
        </form>
    </div>

    <!-- 상품 목록 -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
        <!-- 목록 헤더 -->
        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center">
                        <input type="checkbox" id="select-all" @click="toggleSelectAll()" 
                               class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                        <label for="select-all" class="ml-2 text-sm font-medium text-gray-700 dark:text-gray-300">전체 선택</label>
                    </div>
                    <span class="text-sm text-gray-500 dark:text-gray-400" x-show="selectedProducts.length > 0">
                        <span x-text="selectedProducts.length"></span>개 선택됨
                    </span>
                </div>
                
                <div class="flex items-center space-x-3">
                    <!-- 일괄 작업 버튼 -->
                    <div x-show="selectedProducts.length > 0" class="flex items-center space-x-2">
                        <button @click="bulkAction('activate')" 
                                class="px-3 py-1 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors duration-200">
                            활성화
                        </button>
                        <button @click="bulkAction('deactivate')" 
                                class="px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200">
                            비활성화
                        </button>
                        <button @click="bulkAction('delete')" 
                                class="px-3 py-1 text-sm bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors duration-200">
                            삭제
                        </button>
                    </div>
                    
                    <!-- 정렬 -->
                    <select name="sort" onchange="this.form.submit()" 
                            class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white">
                        <option value="-created_at" {% if current_filters.sort == '-created_at' %}selected{% endif %}>최신순</option>
                        <option value="created_at" {% if current_filters.sort == 'created_at' %}selected{% endif %}>오래된순</option>
                        <option value="name" {% if current_filters.sort == 'name' %}selected{% endif %}>상품명순</option>
                        <option value="-selling_price" {% if current_filters.sort == '-selling_price' %}selected{% endif %}>가격 높은순</option>
                        <option value="selling_price" {% if current_filters.sort == 'selling_price' %}selected{% endif %}>가격 낮은순</option>
                        <option value="-stock_quantity" {% if current_filters.sort == '-stock_quantity' %}selected{% endif %}>재고 많은순</option>
                        <option value="stock_quantity" {% if current_filters.sort == 'stock_quantity' %}selected{% endif %}>재고 적은순</option>
                    </select>
                    
                    <!-- 내보내기 -->
                    <div class="relative" x-data="{ open: false }">
                        <button @click="open = !open" 
                                class="px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200">
                            <i class="fas fa-download mr-2"></i>내보내기
                        </button>
                        <div x-show="open" @click.away="open = false" 
                             class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-10">
                            <a href="{% url 'products:export_csv' %}{% if request.GET %}?{{ request.GET.urlencode }}{% endif %}"
                               class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                <i class="fas fa-file-csv mr-2"></i>CSV 파일
                            </a>
                            <a href="{% url 'products:export_excel' %}{% if request.GET %}?{{ request.GET.urlencode }}{% endif %}"
                               class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                <i class="fas fa-file-excel mr-2"></i>Excel 파일
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 상품 테이블 -->
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                <thead class="bg-gray-50 dark:bg-gray-700">
                    <tr>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                        </th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                            이미지
                        </th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                            상품 정보
                        </th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                            가격
                        </th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                            재고
                        </th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                            상태
                        </th>
                        <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                            작업
                        </th>
                    </tr>
                </thead>
                <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                    {% for product in products %}
                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200">
                        <td class="px-6 py-4 whitespace-nowrap">
                            <input type="checkbox" value="{{ product.id }}" 
                                   @change="toggleProductSelection('{{ product.id }}')"
                                   class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                        </td>
                        
                        <td class="px-6 py-4 whitespace-nowrap">
                            {% if product.images.all %}
                                {% with product.images.all.0 as first_image %}
                                <img src="{{ first_image.image.url }}" alt="{{ product.name }}" 
                                     class="w-12 h-12 rounded-lg object-cover">
                                {% endwith %}
                            {% else %}
                                <div class="w-12 h-12 bg-gray-200 dark:bg-gray-600 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-image text-gray-400"></i>
                                </div>
                            {% endif %}
                        </td>
                        
                        <td class="px-6 py-4">
                            <div class="flex flex-col">
                                <div class="text-sm font-medium text-gray-900 dark:text-white">
                                    <a href="{% url 'products:detail' product.id %}" 
                                       class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-200">
                                        {{ product.name }}
                                    </a>
                                </div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">
                                    SKU: {{ product.sku }}
                                </div>
                                {% if product.brand %}
                                <div class="text-xs text-gray-400 dark:text-gray-500">
                                    {{ product.brand.name }}
                                </div>
                                {% endif %}
                                {% if product.category %}
                                <div class="text-xs text-gray-400 dark:text-gray-500">
                                    {{ product.category.name }}
                                </div>
                                {% endif %}
                            </div>
                        </td>
                        
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex flex-col">
                                <div class="text-sm font-medium text-gray-900 dark:text-white">
                                    ₩{{ product.selling_price|floatformat:0|intcomma }}
                                </div>
                                {% if product.discount_price %}
                                <div class="text-xs text-red-500">
                                    할인: ₩{{ product.discount_price|floatformat:0|intcomma }}
                                </div>
                                {% endif %}
                            </div>
                        </td>
                        
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <span class="text-sm font-medium text-gray-900 dark:text-white">
                                    {{ product.stock_quantity|intcomma }}
                                </span>
                                {% if product.stock_quantity == 0 %}
                                    <span class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                                        품절
                                    </span>
                                {% elif product.stock_quantity <= product.min_stock_level %}
                                    <span class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                        부족
                                    </span>
                                {% endif %}
                            </div>
                        </td>
                        
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex flex-col space-y-1">
                                {% if product.status == 'ACTIVE' %}
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                        활성
                                    </span>
                                {% else %}
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                                        비활성
                                    </span>
                                {% endif %}
                                {% if product.is_featured %}
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                        추천
                                    </span>
                                {% endif %}
                            </div>
                        </td>
                        
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                            <div class="flex items-center justify-end space-x-2">
                                <a href="{% url 'products:detail' product.id %}" 
                                   class="text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300">
                                    <i class="fas fa-eye"></i>
                                </a>
                                <a href="{% url 'products:edit' product.id %}" 
                                   class="text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300">
                                    <i class="fas fa-edit"></i>
                                </a>
                                <button @click="deleteProduct('{{ product.id }}', '{{ product.name }}')" 
                                        class="text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="7" class="px-6 py-12 text-center">
                            <div class="flex flex-col items-center">
                                <i class="fas fa-box-open text-4xl text-gray-400 mb-4"></i>
                                <p class="text-gray-500 dark:text-gray-400">등록된 상품이 없습니다.</p>
                                <a href="{% url 'products:create' %}" 
                                   class="mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700">
                                    <i class="fas fa-plus mr-2"></i>
                                    첫 상품 등록하기
                                </a>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- 페이지네이션 -->
        {% if page_obj.has_other_pages %}
        <div class="px-6 py-4 border-t border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <p class="text-sm text-gray-700 dark:text-gray-300">
                        <span class="font-medium">{{ page_obj.start_index }}</span> - 
                        <span class="font-medium">{{ page_obj.end_index }}</span> of 
                        <span class="font-medium">{{ page_obj.paginator.count }}</span> 결과
                    </p>
                </div>
                
                <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px" aria-label="Pagination">
                    {% if page_obj.has_previous %}
                        <a href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page={{ page_obj.previous_page_number }}"
                           class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">
                            <i class="fas fa-chevron-left"></i>
                        </a>
                    {% endif %}
                    
                    {% for num in page_obj.paginator.page_range %}
                        {% if page_obj.number == num %}
                            <span class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-blue-50 text-sm font-medium text-blue-600">
                                {{ num }}
                            </span>
                        {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                            <a href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page={{ num }}"
                               class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50">
                                {{ num }}
                            </a>
                        {% endif %}
                    {% endfor %}
                    
                    {% if page_obj.has_next %}
                        <a href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page={{ page_obj.next_page_number }}"
                           class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    {% endif %}
                </nav>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<script>
function productList() {
    return {
        selectedProducts: [],
        
        toggleSelectAll() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"][value]');
            const allChecked = this.selectedProducts.length === checkboxes.length;
            
            if (allChecked) {
                this.selectedProducts = [];
                checkboxes.forEach(cb => cb.checked = false);
            } else {
                this.selectedProducts = [];
                checkboxes.forEach(cb => {
                    cb.checked = true;
                    this.selectedProducts.push(cb.value);
                });
            }
        },
        
        toggleProductSelection(productId) {
            const index = this.selectedProducts.indexOf(productId);
            if (index > -1) {
                this.selectedProducts.splice(index, 1);
            } else {
                this.selectedProducts.push(productId);
            }
        },
        
        async bulkAction(action) {
            if (this.selectedProducts.length === 0) {
                Swal.fire('알림', '선택된 상품이 없습니다.', 'warning');
                return;
            }
            
            const actionNames = {
                'activate': '활성화',
                'deactivate': '비활성화',
                'delete': '삭제'
            };
            
            const result = await Swal.fire({
                title: `${this.selectedProducts.length}개 상품을 ${actionNames[action]}하시겠습니까?`,
                text: action === 'delete' ? '이 작업은 되돌릴 수 없습니다.' : '',
                icon: action === 'delete' ? 'warning' : 'question',
                showCancelButton: true,
                confirmButtonText: '확인',
                cancelButtonText: '취소',
                confirmButtonColor: action === 'delete' ? '#dc3545' : '#3085d6'
            });
            
            if (result.isConfirmed) {
                try {
                    const formData = new FormData();
                    this.selectedProducts.forEach(id => {
                        formData.append('product_ids', id);
                    });
                    formData.append('action', action);
                    
                    const response = await fetch('{% url "products:bulk_action" %}', {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'X-CSRFToken': '{{ csrf_token }}'
                        }
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        Swal.fire('성공', data.message, 'success').then(() => {
                            location.reload();
                        });
                    } else {
                        Swal.fire('오류', data.error, 'error');
                    }
                } catch (error) {
                    Swal.fire('오류', `처리 중 오류가 발생했습니다. ${error}`, 'error');
                }
            }
        },
        
        async deleteProduct(productId, productName) {
            const result = await Swal.fire({
                title: '상품 삭제',
                text: `"${productName}"을(를) 삭제하시겠습니까?`,
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: '삭제',
                cancelButtonText: '취소',
                confirmButtonColor: '#dc3545'
            });
            
            if (result.isConfirmed) {
                try {
                    const formData = new FormData();
                    formData.append('csrfmiddlewaretoken', document.querySelector('[name=csrfmiddlewaretoken]').value);
                    
                    const response = await fetch(`/products/${productId}/delete/`, {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (response.ok) {
                        Swal.fire('삭제 완료', '상품이 삭제되었습니다.', 'success').then(() => {
                            location.reload();
                        });
                    } else {
                        Swal.fire('오류', '삭제 중 오류가 발생했습니다.', 'error');
                    }
                } catch (error) {
                    Swal.fire('오류', '처리 중 오류가 발생했습니다.', 'error');
                }
            }
        }
    }
}
</script>
{% endblock %}